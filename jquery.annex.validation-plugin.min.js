!function(a){"function"==typeof define&&define.amd?define(["jquery","jquery-annex"],a):a(jQuery)}(function(a){return function(){if(!a||!a.fn||!a().jquery)throw'jQueryAnnex Validation Plugin | cannot extend jQuery, since it does not seem to be available as "jQuery" or is missing basic functionality';if(!a.jqueryAnnexData)throw"jQueryAnnex Validation Plugin | cannot extend jQuery Annex, since it does not seem to be available yet"}(),a.extend(a.jqueryAnnexData,{validation:{config:{isValid:!0,messages:[],registeredTargets:{all:[]},globalCallback:a.noop,additionalWidgetEvents:"",validateOnWidgetEvents:!0,defaultValidationData:{isValid:!0,isOptional:!1,hasNonOptionalValue:!1,optionalValues:[""],asyncError:!1,asyncCount:0,asyncLeft:0,messages:[],values:[]}},functions:{validate:function(t,i){if(a.isSet(i)||(i=!1),!i||i&&a.jqueryAnnexData.validation.config.validateOnWidgetEvents){var n=t.length;a.jqueryAnnexData.validation.config.isValid=!0,a.jqueryAnnexData.validation.config.messages=[],a.each(t,function(t,i){if(a.isSet(i)){var e=i.data("validationdata");if(a.isSet(e)){i.first().one("finished.validation",function(t,i){t.stopPropagation(),a.jqueryAnnexData.validation.config.isValid=a.jqueryAnnexData.validation.config.isValid&&i,i||a.merge(a.jqueryAnnexData.validation.config.messages,a(t.target).data("validationdata").status.messages),n--,n<=0&&(a.jqueryAnnexData.validation.config.globalCallback(a.jqueryAnnexData.validation.config.isValid,a.jqueryAnnexData.validation.config.messages),a(document).trigger("finished.validation",a.jqueryAnnexData.validation.config.isValid))});var s=e.status.isOptional,r=e.status.asyncCount;e.status=a.extend(!0,{},a.jqueryAnnexData.validation.config.defaultValidationData),e.status.isOptional=s,e.status.asyncCount=r,e.status.asyncLeft=r,e.status.values=e.container.formDataToObject()[i.attr("name").replace(/\[\]/,"")],a.isSet(e.status.values)?a.isArray(e.status.values)||(e.status.values=[e.status.values]):e.status.values=[],e.status.isOptional&&a.each(e.status.values,function(t,i){if(a.inArray(i,e.status.optionalValues)==-1)return e.status.hasNonOptionalValue=!0,!1}),i.data("validationdata",e),a.jqueryAnnexData.validation.functions.unmarkValidationError(i),e.status.isOptional&&!e.status.hasNonOptionalValue||a.isSet(i.attr("disabled"))?e.status.asyncLeft=0:(a.each(e.rules,function(a,t){e.status.isValid=t()&&e.status.isValid}),e.status.isValid||(a.jqueryAnnexData.validation.functions.markValidationError(i),e.status.asyncLeft<=0&&(a.isSet(e.callback)&&a.isFunction(e.callback)&&e.callback(!1,e.status.messages,i),i.trigger("error.validation",e.status.messages)))),e.status.asyncLeft<=0&&(e.status.isValid&&(a.isSet(e.callback)&&a.isFunction(e.callback)&&e.callback(!0,[],i),i.trigger("success.validation")),i.trigger("finished.validation",e.status.isValid))}else i.unsetValidation(!0)}})}},markValidationError:function(t){var i=t.data("validationdata").errorContainer;a.isSet(i)&&i.addClass("validationerror"),t.addClass("validationerror")},unmarkValidationError:function(t){var i=t.data("validationdata").errorContainer;a.isSet(i)&&i.removeClass("validationerror"),t.removeClass("validationerror")},asyncCallbackFactory:function(t,i){var n=t.data("validationdata").status,e=t.data("validationdata").callback,s=function(s){var r=a.isA(s,"boolean")?s:""===a.trim(""+s);n.asyncError=n.asyncError&&!r,n.isValid=n.isValid&&r,n.asyncLeft--,n.isValid?n.asyncLeft<=0&&(a.isSet(e)&&a.isFunction(e)&&e(!0,[],t),t.trigger("success.validation")):(a.jqueryAnnexData.validation.functions.markValidationError(t),r||(a.isA(s,"string")&&""!==a.trim(""+s)?n.messages.push(a.trim(""+s)):n.messages.push(i)),n.asyncLeft<=0&&(a.isSet(e)&&a.isFunction(e)&&e(!1,n.messages,t),t.trigger("error.validation",n.messages))),n.asyncLeft<=0&&t.trigger("finished.validation",n.isValid)};return s},asyncErrorCallbackFactory:function(t){var i=t.data("validationdata").status,n=t.data("validationdata").callback,e=function(){i.asyncLeft--,i.asyncError=!0,i.isValid=i.isValid&&!i.asyncError,a.jqueryAnnexData.validation.functions.markValidationError(t),i.messages.push("communication error, could not retrieve data from server"),a.log("communication error, could not retrieve data from server"),i.asyncLeft<=0&&(a.isSet(n)&&a.isFunction(n)&&n(!1,i.messages,t),t.trigger("error.validation",i.messages),t.trigger("finished.validation",!1))};return e}},validators:{customcase:function(t,i){var n=!0,e=a(this).data("validationdata").status,s=null;if(a.isArray(i)&&i.length<2&&(i=i[0]),a.isFunction(i)){var r=i(a.jqueryAnnexData.validation.functions.asyncCallbackFactory(a(this),t),a.jqueryAnnexData.validation.functions.asyncErrorCallbackFactory(a(this)));a.isSet(r)&&(a.isA(r,"boolean")?n=r:""!==a.trim(""+r)&&(n=!1,s=a.trim(""+r)))}else a.isA(i,"boolean")?n=i:""!==a.trim(""+i)&&(n=!1,s=a.trim(""+i));return a.isSet(s)?e.messages.push(t):!n&&a.isSet(t)&&""!==a.trim(t)&&e.messages.push(t),n},required:function(t){var i=!0,n=a(this).data("validationdata").status;return i=1==n.values.length?""!==n.values[0]:n.values.length>0,!i&&a.isSet(t)&&""!==t&&n.messages.push(t),i},notempty:function(t){var i=Array.prototype.slice.call(arguments,1),n=!0,e=a(this).data("validationdata").status,s=[""];return a.merge(s,i),n=1==e.values.length?a.inArray(a.trim(e.values[0]),s)==-1:0!==e.values.length,!n&&a.isSet(t)&&""!==a.trim(t)&&e.messages.push(t),n},optional:function(){return!0},minlength:function(t,i){i=parseInt(i,10);var n=!0,e=a(this).data("validationdata").status;return n=1==e.values.length?e.values[0].length>=i:e.values.length>=i,!n&&a.isSet(t)&&""!==a.trim(t)&&e.messages.push(t),n},maxlength:function(t,i){i=parseInt(i,10);var n=!0,e=a(this).data("validationdata").status;return n=1==e.values.length?e.values[0].length<=i:e.values.length<=i,!n&&a.isSet(t)&&""!==a.trim(t)&&e.messages.push(t),n},rangelength:function(t,i,n){var e=!0,s=a(this).data("validationdata").status;return a.isSet(i,n)&&(e=a.proxy(a.jqueryAnnexData.validation.validators.minlength,a(this),null,i)()&&a.proxy(a.jqueryAnnexData.validation.validators.maxlength,a(this),null,n)()),!e&&a.isSet(t)&&""!==a.trim(t)&&s.messages.push(t),e},min:function(t,i){var n=!0,e=a(this).data("validationdata").status;return a.each(e.values,function(t,e){if(n=n&&a.isNumeric(e)&&parseInt(e,10)>=i,!n)return!1}),!n&&a.isSet(t)&&""!==a.trim(t)&&e.messages.push(t),n},max:function(t,i){var n=!0,e=a(this).data("validationdata").status;return a.each(e.values,function(t,e){if(n=n&&a.isNumeric(e)&&parseInt(e,10)<=i,!n)return!1}),!n&&a.isSet(t)&&""!==a.trim(t)&&e.messages.push(t),n},range:function(t,i,n){var e=!0,s=a(this).data("validationdata").status;return a.isSet(i,n)&&(e=a.proxy(a.jqueryAnnexData.validation.validators.min,a(this),null,i)()&&a.proxy(a.jqueryAnnexData.validation.validators.max,a(this),null,n)()),!e&&a.isSet(t)&&""!==a.trim(t)&&s.messages.push(t),e},email:function(t){var i=!0,n=a(this).data("validationdata").status;return a.each(n.values,function(a,t){var n=/^[^@]{1,64}@[^@]{1,255}$/.test(t);if(n){for(var e=t.split("@"),s=e[0].split("."),r=0;r<s.length;r++)/^(([A-Za-z0-9!#$%&'*+\/=?^_`{|}~-][A-Za-z0-9!#$%&'*+\/=?^_`{|}~\.-]{0,63})|(\\\"[^(\\|\\\")]{0,62}\\\"))$/.test(s[r])||(n=!1);var l="";if(!/^\[?[0-9\.]+\]?$/.test(e[1]))for(l=e[1].split("."),l.length<2&&(n=!1),r=0;r<l.length;r++)/^(([A-Za-z0-9][A-Za-z0-9-]{0,61}[A-Za-z0-9])|([A-Za-z0-9]{2,5}))$/.test(l[r])||(n=!1)}if(i=i&&n,!i)return!1}),!i&&a.isSet(t)&&""!==a.trim(t)&&n.messages.push(t),i},url:function(t){var i=!0,n=a(this).data("validationdata").status;return a.each(n.values,function(a,t){if(i=i&&/^(https?|ftp)\:\/\/([a-z0-9+!*(),;?&=$_.-]+(\:[a-z0-9+!*(),;?&=$_.-]+)?@)?([a-z0-9+$_-]+\.)*[a-z0-9+$_-]{2,3}(\:[0-9]{2,5})?(\/([a-z0-9+$_-]\.?)+)*\/?(\?[a-z+&$_.-][a-z0-9;:@\/&%=+$_.-]*)?(#[a-z_.-][a-z0-9+$_.-]*)?$/.test(t),!i)return!1}),!i&&a.isSet(t)&&""!==a.trim(t)&&n.messages.push(t),i},date:function(t,i){var n=!0,e=a(this).data("validationdata").status;return a.each(e.values,function(t,e){if(a.isSet(i)&&"__internal__"==i){var s=e.split(" ");e=s.length>=2?a.trim(s[0]):""}var r=/^(0?[1-9]|1[0-2])\/(0?[1-9]|[1-2][0-9]|3[0-1])\/([1-2][0-9]{3})$/.test(e),l=r?e.split("/"):null;if(r)for(var o=0;o<2;o++)l[o].length<2&&(l[o]="0"+l[o]);var u=r?new Date(l[2]+"-"+l[0]+"-"+l[1]):null,d=null!==u&&null!==l&&(!/Invalid|NaN/.test(u)&&parseInt(l[0],10)==u.getMonth()+1&&parseInt(l[1],10)==u.getDate()&&parseInt(l[2],10)==u.getFullYear());if(n=n&&d,!n)return!1}),!n&&a.isSet(t)&&""!==a.trim(t)&&e.messages.push(t),n},time:function(t,i){var n=!0,e=a(this).data("validationdata").status;return a.each(e.values,function(t,e){if(a.isSet(i)&&"__internal__"==i){var s=e.split(" ");s.length>=2?(e=a.trim(s[1]),s.length>=3&&(e+=" "+a.trim(s[2]))):e=""}var r=/^((0?[0-9]|1[0-1])\:[0-5][0-9](\:[0-5][0-9])? ?(am|AM|pm|PM)|12\:[0-5][0-9](\:[0-5][0-9])? ?(pm|PM))$/.test(e);if(n=n&&r,!n)return!1}),!n&&a.isSet(t)&&""!==a.trim(t)&&e.messages.push(t),n},datetime:function(t){var i=!0,n=a(this).data("validationdata").status;return i=a.proxy(a.jqueryAnnexData.validation.validators.date,a(this),null,"__internal__")()&&a.proxy(a.jqueryAnnexData.validation.validators.time,a(this),null,"__internal__")(),!i&&a.isSet(t)&&""!==a.trim(t)&&n.messages.push(t),i},dateISO:function(t,i){var n=!0,e=a(this).data("validationdata").status;return a.each(e.values,function(t,e){if(a.isSet(i)&&"__internal__"==i){var s=e.replace(/T/," ").split(" ");e=s.length>=2?a.trim(s[0]):""}var r=/^([1-2][0-9]{3})\-(0?[1-9]|1[0-2])\-(0?[1-9]|[1-2][0-9]|3[0-1])$/.test(e),l=r?e.split("-"):null;if(r)for(var o=1;o<3;o++)l[o].length<2&&(l[o]="0"+l[o]);var u=r?new Date(parseInt(l[0],10),parseInt(l[1],10)-1,parseInt(l[2],10)):null,d=null!==u&&null!==l&&(!/Invalid|NaN/.test(u)&&parseInt(l[0],10)==u.getFullYear()&&parseInt(l[1],10)==u.getMonth()+1&&parseInt(l[2],10)==u.getDate());if(n=n&&d,!n)return!1}),!n&&a.isSet(t)&&""!==a.trim(t)&&e.messages.push(t),n},timeISO:function(t,i){var n=!0,e=a(this).data("validationdata").status;return a.each(e.values,function(t,e){if(a.isSet(i)&&"__internal__"==i){var s=e.replace(/T/," ").split(" ");e=s.length>=2?a.trim(s[1]):""}var r=/^([0-1][0-9]|2[0-3])\:[0-5][0-9]\:[0-5][0-9]$/.test(e);if(n=n&&r,!n)return!1}),!n&&a.isSet(t)&&""!==a.trim(t)&&e.messages.push(t),n},datetimeISO:function(t){var i=!0,n=a(this).data("validationdata").status;return i=a.proxy(a.jqueryAnnexData.validation.validators.dateISO,a(this),null,"__internal__")()&&a.proxy(a.jqueryAnnexData.validation.validators.timeISO,a(this),null,"__internal__")(),!i&&a.isSet(t)&&""!==a.trim(t)&&n.messages.push(t),i},dateDE:function(t,i){var n=!0,e=a(this).data("validationdata").status;return a.each(e.values,function(t,e){if(a.isSet(i)&&"__internal__"==i){var s=e.split(" ");e=s.length>=2?a.trim(s[0]):""}var r=/^(0?[1-9]|[1-2][0-9]|3[0-1])\.(0?[1-9]|1[0-2])\.([1-2][0-9]{3})$/.test(e),l=r?e.split("."):null;if(r)for(var o=0;o<2;o++)l[o].length<2&&(l[o]="0"+l[o]);var u=r?new Date(parseInt(l[2],10),parseInt(l[1],10)-1,parseInt(l[0],10)):null,d=null!==u&&null!==l&&(!/Invalid|NaN/.test(u)&&parseInt(l[0],10)==u.getDate()&&parseInt(l[1],10)==u.getMonth()+1&&parseInt(l[2],10)==u.getFullYear());if(n=n&&d,!n)return!1}),!n&&a.isSet(t)&&""!==a.trim(t)&&e.messages.push(t),n},timeDE:function(t,i){var n=!0,e=a(this).data("validationdata").status;return a.each(e.values,function(t,e){if(a.isSet(i)&&"__internal__"==i){var s=e.split(" ");e=s.length>=2?a.trim(s[1]):""}var r=/^([0-1][0-9]|2[0-3])\:[0-5][0-9](\:[0-5][0-9])?h?$/.test(e);if(n=n&&r,!n)return!1}),!n&&a.isSet(t)&&""!==a.trim(t)&&e.messages.push(t),n},datetimeDE:function(t){var i=!0,n=a(this).data("validationdata").status;return i=a.proxy(a.jqueryAnnexData.validation.validators.dateDE,a(this),null,"__internal__")()&&a.proxy(a.jqueryAnnexData.validation.validators.timeDE,a(this),null,"__internal__")(),!i&&a.isSet(t)&&""!==a.trim(t)&&n.messages.push(t),i},number:function(t){var i=!0,n=a(this).data("validationdata").status;return a.each(n.values,function(a,t){if(i=i&&(t==""+parseInt(t,10)||t==""+parseFloat(t)),!i)return!1}),!i&&a.isSet(t)&&""!==a.trim(t)&&n.messages.push(t),i},numberDE:function(t){var i=!0,n=a(this).data("validationdata").status;return a.each(n.values,function(a,t){var n=/^[0-9]+(\,[0-9]+)?$/.test(t);if(n&&(t=t.replace(/\,/g,"."),n=t==""+parseInt(t,10)||t==""+parseFloat(t)),i=i&&n,!i)return!1}),!i&&a.isSet(t)&&""!==a.trim(t)&&n.messages.push(t),i},digits:function(t){var i=!0,n=a(this).data("validationdata").status;return a.each(n.values,function(a,t){if(i=i&&/^[0-9]+$/.test(t),!i)return!1}),!i&&a.isSet(t)&&""!==a.trim(t)&&n.messages.push(t),i},creditcard:function(t){var i=!0,n=a(this).data("validationdata").status;return a.each(n.values,function(a,t){if(i=i&&/^[0-9]{3,4}\-[0-9]{4}\-[0-9]{4}\-[0-9]{4}$/.test(t),!i)return!1}),!i&&a.isSet(t)&&""!==a.trim(t)&&n.messages.push(t),i},characterclass:function(t,i){var n=!0,e=a(this).data("validationdata").status,s=new RegExp("^["+i+"]*$");return a.each(e.values,function(a,t){if(n=n&&s.test(t),!n)return!1}),!n&&a.isSet(t)&&""!==a.trim(t)&&e.messages.push(t),n}}}}),a.extend({triggerValidation:function(t){t=a.orDefault(t,"all","string"),a.jqueryAnnexData.validation.functions.validate(a.jqueryAnnexData.validation.config.registeredTargets[t])},executeOnValidation:function(t){a.assert(a.isFunction(t),"executeOnValidation | callback is no function"),a.jqueryAnnexData.validation.config.globalCallback=t},validationIsTriggeredByWidgetEvents:function(t){t=!!t,a.jqueryAnnexData.validation.config.validateOnWidgetEvents=t},setAdditionalValidationWidgetEvents:function(t){a.assert(a.isArray(t),"events need to be an array");var i="";a.each(t,function(a,t){i+=t+".validation "}),i=" "+a.trim(i),a.jqueryAnnexData.validation.config.additionalWidgetEvents=i},setValidationFromTags:function(){a(":input[data-validation]").each(function(){if(a.isPlainObject(a(this).data("validation"))||a.isArray(a(this).data("validation"))){var t=a.isSet(a(this).data("validation-callback"))&&a.isFunction(a(this).data("validation-callback"))?a(this).data("validation-callback"):null,i=a.isSet(a(this).data("validation-errorcontainer"))&&a.exists(a(this).data("validation-errorcontainer"))?a(this).data("validation-errorcontainer"):null,n=a.isSet(a(this).data("validation-container"))&&a.exists(a(this).data("validation-container"))?a(this).data("validation-container"):null,e=a.isSet(a(this).data("validation-targetgroup"))?a(this).data("validation-targetgroup"):null,s=!!a.isSet(a(this).data("validation-suppresssubmit"))&&"true"==a(this).data("validation-suppresssubmit");a(this).setValidation(a(this).data("validation"),t,i,n,e,s)}})}}),a.fn.extend({setValidation:function(t,i,n,e,s,r){return t=a.orDefault(t,[],"array"),s=a.orDefault(s,"all","string"),r=a.orDefault(r,!1,"bool"),a.isSet(e)?e=e.find(":input"):(e=a(this).closest("form"),a.exists(e)?(e.off("submit.validation"),e.on("submit.validation",function(t,i){a.isSet(i)?i&&!r||t.preventDefault():(t.preventDefault(),a(document).one("finished.validation",function(a,t){e.trigger("submit.validation",t)}),a.jqueryAnnexData.validation.functions.validate(a.jqueryAnnexData.validation.config.registeredTargets[s]))})):e=a(this)),a(this).each(function(){a.assert(a(this).is(":input"),"setValidation | element is no value-bearing form element"),a.assert(a.isSet(a(this).attr("name")),'setValidation | element has no attribute "name"');var r=this;a(this).removeData("validationdata");var l={status:a.extend({},a.jqueryAnnexData.validation.config.defaultValidationData),rules:{},callback:i,container:e,errorContainer:n},o=0;a.each(t,function(t,i){var n=a.objectLength(i);if(a.isPlainObject(i)&&n>=1&&n<=2){2==n&&a.assert(a.exists("args",i));var e=null,s=null,u=a.exists("args",i)?a.isArray(i.args)?i.args:[i.args]:[];if(a.each(i,function(a,t){if("args"!=a)return e=a,s=t,!1}),a.isSet(e)){e=e.split("_async");var d=e.length>1;e=e[0],"optional"==e&&(l.status.isOptional=!0,a.merge(l.status.optionalValues,u)),a.isFunction(a.jqueryAnnexData.validation.validators[e])&&(d&&o++,l.rules[e+"_"+a.randomUUID(!0)]=a.proxy.apply(a,a.merge([],a.merge([a.jqueryAnnexData.validation.validators[e],a(r),""+a.trim(s)],u))))}}}),l.status.asyncCount=o,a.jqueryAnnexData.validation.config.registeredTargets.all.push(a(this)),"all"!=s&&(a.isSet(a.jqueryAnnexData.validation.config.registeredTargets[s])||(a.jqueryAnnexData.validation.config.registeredTargets[s]=[]),a.jqueryAnnexData.validation.config.registeredTargets[s].push(a(this)));var u=null,d=e.find('[name="'+a(this).attr("name")+'"]');0===d.length&&(d=e.filter('[name="'+a(this).attr("name")+'"]')),d.each(function(){a(this).data("validationdata",l).off("change.validation blur.validation"+a.jqueryAnnexData.validation.config.additionalWidgetEvents).on("change.validation blur.validation"+a.jqueryAnnexData.validation.config.additionalWidgetEvents,function(){a.countermand(u),u=a.schedule(10,function(){a.jqueryAnnexData.validation.functions.validate(a.jqueryAnnexData.validation.config.registeredTargets[s],!0)})})})}),this},unsetValidation:function(t,i){return t=a.orDefault(t,!1,"bool"),i=a.isSet(i)&&a.jqueryAnnexData.validation.config.registeredTargets[i]?""+i:null,a(this).each(function(){a.assert(a(this).is(":input"),"unsetValidation | element is no value-bearing form element"),a.assert(a.isSet(a(this).attr("name")),'unsetValidation | element has no attribute "name"');var n=this;if(a.isSet(a(this).data("validationdata"))||t){a(this).removeData("validationdata");var e={};a.isSet(i)?(e.all=a.jqueryAnnexData.validation.config.registeredTargets.all,e[i]=a.jqueryAnnexData.validation.config.registeredTargets[i]):e=a.jqueryAnnexData.validation.config.registeredTargets,a.each(e,function(t,i){if(a.isSet(i)){for(var e=-1,s=0;s<i.length;s++)if(a(n).attr("name")==i[s].attr("name")){e=s;break}e>=0&&(a.jqueryAnnexData.validation.config.registeredTargets[t]=a.removeFromArray(a.jqueryAnnexData.validation.config.registeredTargets[t],e)),0===a.jqueryAnnexData.validation.config.registeredTargets[t].length&&(a(this).closest("form").off("submit.validation"),"all"!=t&&delete a.jqueryAnnexData.validation.config.registeredTargets[t])}}),a(this).off("change.validation blur.validation"+a.jqueryAnnexData.validation.config.additionalWidgetEvents)}}),this}}),a});