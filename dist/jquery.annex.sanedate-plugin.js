!function(e,t){var a=e.jQuery||e.$;if("function"==typeof define&&define.amd)define(["jqueryannex"],t);else if("object"==typeof module&&module.exports){if(!e.__AVA_ENV__)try{(a=a||require("jquery")).jqueryAnnexData||(a=require("jqueryannex"))}catch(e){}module.exports=a?t(a):t}else t(a)}("undefined"!=typeof window?window:this,function(l){if(!l||!l.fn||!l().jquery)throw'jQueryAnnex SaneDate Plugin | cannot extend jQuery, since it does not seem to be available as "jQuery" or is missing basic functionality';if(l.jqueryAnnexData)return l.extend({SaneDate:function(){}}),l.SaneDate=l.Class.extend({_date:null,_compareDate:null,_utc:!1,_ignoreInvalidPartChanged:!1,_valid:!0,init:function(e,t,a,s,n,i,r){l.isA(e,"date")||(e=l.orDefault(e,null,"string"));var o=!0,t={type:"date",year:null,month:l.orDefault(t,null,"int"),date:l.orDefault(a,null,"int"),hours:l.orDefault(s,null,"int"),minutes:l.orDefault(n,null,"int"),seconds:l.orDefault(i,null,"int"),milliseconds:l.orDefault(r,null,"int")};if(this._setupDatePartGettersAndSetters(),l.isSet(e))if(l.isA(e,"date"))l.isNaN(e.getDate())?this._setInvalid():this._date=e;else{if(!l.isA(e,"date"))if((""+e).indexOf("-")<0)t.year=parseInt(e,10),l.isSet(t.hours)&&(t.type="datetime");else try{t=this._parseIsoString(e)}catch(e){t=null}if(l.isSet(t))try{o=this._verifyDateParts(t)}catch(e){o=!1}l.isSet(t)&&o?this._date=this._partsToDate(t):this._setInvalid()}else this._date=new Date},_setupDatePartGettersAndSetters:function(){var t=this,e={enumerable:!0};Object.defineProperty(this,"valid",l.extend({},e,{set:function(){throw new Error("SaneDate set valid | valid is not settable")},get:function(){return this._valid}})),Object.defineProperty(this,"utc",l.extend({},e,{set:function(e){this.setUtc(e)},get:function(){return this._utc}})),Object.defineProperty(this,"year",l.extend({},e,{set:function(e){e=parseInt(e,10),l.assert(!l.isNaN(e),"SaneDate set year | value is not usable as int"),l.assert(0<=e&&e<=9999,"SaneDate set year | this implementation works with years between 0 and 9999"),t.utc?t._tryDatePartChange(e,"setUTCFullYear","getUTCFullYear",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e,"setFullYear","getFullYear",!t._ignoreInvalidPartChanged)},get:function(){if(l.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCFullYear():t._date.getFullYear()}})),Object.defineProperty(this,"month",l.extend({},e,{set:function(e){e=parseInt(e,10),l.assert(!l.isNaN(e),"SaneDate set month | value is not usable as int"),t.utc?t._tryDatePartChange(e-1,"setUTCMonth","getUTCMonth",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e-1,"setMonth","getMonth",!t._ignoreInvalidPartChanged)},get:function(){if(l.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCMonth()+1:t._date.getMonth()+1}})),Object.defineProperty(this,"date",l.extend({},e,{set:function(e){e=parseInt(e,10),l.assert(!l.isNaN(e),"SaneDate set date | value is not usable as int"),t.utc?t._tryDatePartChange(e,"setUTCDate","getUTCDate",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e,"setDate","getDate",!t._ignoreInvalidPartChanged)},get:function(){if(l.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCDate():t._date.getDate()}})),Object.defineProperty(this,"hours",l.extend({},e,{set:function(e){e=parseInt(e,10),l.assert(!l.isNaN(e),"SaneDate set hours | value is not usable as int"),t.utc?t._tryDatePartChange(e,"setUTCHours","getUTCHours",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e,"setHours","getHours",!t._ignoreInvalidPartChanged)},get:function(){if(l.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCHours():t._date.getHours()}})),Object.defineProperty(this,"minutes",l.extend({},e,{set:function(e){e=parseInt(e,10),l.assert(!l.isNaN(e),"SaneDate set minutes | value is not usable as int"),t.utc?t._tryDatePartChange(e,"setUTCMinutes","getUTCMinutes",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e,"setMinutes","getMinutes",!t._ignoreInvalidPartChanged)},get:function(){if(l.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCMinutes():t._date.getMinutes()}})),Object.defineProperty(this,"seconds",l.extend({},e,{set:function(e){e=parseInt(e,10),l.assert(!l.isNaN(e),"SaneDate set seconds | value is not usable as int"),t.utc?t._tryDatePartChange(e,"setUTCSeconds","getUTCSeconds",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e,"setSeconds","getSeconds",!t._ignoreInvalidPartChanged)},get:function(){if(l.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCSeconds():t._date.getSeconds()}})),Object.defineProperty(this,"milliseconds",l.extend({},e,{set:function(e){e=parseInt(e,10),l.assert(!l.isNaN(e),"SaneDate set milliseconds | value is not usable as int"),t.utc?t._tryDatePartChange(e,"setUTCMilliseconds","getUTCMilliseconds",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e,"setMilliseconds","getMilliseconds",!t._ignoreInvalidPartChanged)},get:function(){if(l.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCMilliseconds():t._date.getMilliseconds()}}))},setUtc:function(e){return this._utc=!!e,this},setIgnoreInvalidPartChanged:function(e){return this._ignoreInvalidPartChanged=!!e,this},getWeekDay:function(e){var t;if(e=l.orDefault(e,!0,"bool"),l.isSet(this._date)&&this._valid)return t=this._utc?this._date.getUTCDay():this._date.getDay(),e&&0===t&&(t=7),e||(t+=1),t},getIsoDateString:function(){var e,t,a;return l.isSet(this._date)&&this._valid?(e=this._utc?this._date.getUTCFullYear():this._date.getFullYear(),t=(t=this._utc?this._date.getUTCMonth()+1:this._date.getMonth()+1)<10?"0"+t:""+t,a=(a=this._utc?this._date.getUTCDate():this._date.getDate())<10?"0"+a:""+a,(e=""+e)<1e3&&(e=this._padValueWithZero(e,4)),l.strFormat("{year}-{month}-{date}",{year:e,month:t,date:a})):null},getIsoString:function(e){e=l.orDefault(e,!0,"bool");var t,a,s,n,i=this.getIsoDateString();return l.isSet(i)?(t=this._utc?this._date.getUTCHours():this._date.getHours(),a=this._utc?this._date.getUTCMinutes():this._date.getMinutes(),s=this._utc?this._date.getUTCSeconds():this._date.getSeconds(),n=this._utc?this._date.getUTCMilliseconds():this._date.getMilliseconds(),i+(e?"T":" ")+l.strFormat("{hours}:{minutes}:{seconds}.{milliseconds}",{hours:t=t<10?"0"+t:""+t,minutes:a=a<10?"0"+a:""+a,seconds:s=s<10?"0"+s:""+s,milliseconds:n=""+n})):null},getVanillaDate:function(){return this._valid?this._date:null},compareTo:function(e,t,a){t=l.orDefault(t,"datetime","string"),a=l.orDefault(a,!0,"bool");var s=this;if(l.isSet(this._date)&&this._valid){var n,i,r,o=null;if((o=l.isA(e,"object")&&l.hasMembers(e,["_date","_valid"])?e:new l.SaneDate(""+e))._valid)return n=0,l.merge(e=[],["getFullYear","getMonth","getDate"]),"datetime"===t&&(l.merge(e,["getHours","getMinutes","getSeconds"]),a&&l.merge(e,["getMilliseconds"])),l.each(e,function(e,t){if(i=s._date[t](),r=o._date[t](),0!==(n=i<r?-1:r<i?1:0))return!1}),n;throw new Error("SaneDate compareTo | invalid compare date")}throw new Error("SaneDate compareTo | date currently not comparable")},move:function(e,t){t=l.orDefault(t,0,"int");var a,s=this,n=["years","months","days","hours","minutes","seconds","milliseconds"];if(l.isSet(this._date)&&this._valid)return a={},l.isPlainObject(e)?a=e:a[""+e]=t,l.each(a,function(e,t){if(!(0<=l.inArray(""+e,n)))throw new Error("SaneDate _move | part must be one of years, months, days, hours, minutes, seconds, milliseconds");switch(""+e){case"years":s._date.setFullYear(s._date.getFullYear()+t);break;case"months":s._date.setMonth(s._date.getMonth()+t);break;case"days":s._date.setDate(s._date.getDate()+t);break;case"hours":s._date.setHours(s._date.getHours()+t);break;case"minutes":s._date.setMinutes(s._date.getMinutes()+t);break;case"seconds":s._date.setSeconds(s._date.getSeconds()+t);break;case"milliseconds":s._date.setMilliseconds(s._date.getMilliseconds()+t)}}),this;throw new Error("SaneDate _move | current date is not usable")},forward:function(e,t){t=l.orDefault(t,0,"int");var a={};return l.isPlainObject(e)?(a=e,l.each(a,function(e,t){a[e]=Math.abs(t)})):a[""+e]=Math.abs(t),this.move(a)},back:function(e,t){t=l.orDefault(t,0,"int");var a={};return l.isPlainObject(e)?(a=e,l.each(a,function(e,t){a[e]=0===t?0:-Math.abs(t)})):a[""+e]=0===t?0:-Math.abs(t),this.move(a)},delta:function(e,t,a){if(t=l.orDefault(t,"days","string"),l.inArray(t,["days","hours","minutes","seconds","milliseconds"])<0)throw new Error('SaneDate delta | largestUnit must be one of "days", "hours", "minutes", "seconds" or "milliseconds"');var s,n,i;if(a=l.orDefault(a,!0,"bool"),l.isSet(this._date)&&this._valid)return i=n=null,s={},n=l.isA(e,"object")&&l.hasMembers(e,["_date","_valid"])?e:new l.SaneDate(""+e),e=(i=a?Math.abs(this._date.getTime()-n._date.getTime()):this._date.getTime()-n._date.getTime())<0,i=Math.abs(i),"days"===t&&(s.days=Math.floor(i/1e3/60/60/24),i-=1e3*s.days*60*60*24,t="hours"),"hours"===t&&(s.hours=Math.floor(i/1e3/60/60),i-=1e3*s.hours*60*60,t="minutes"),"minutes"===t&&(s.minutes=Math.floor(i/1e3/60),i-=1e3*s.minutes*60,t="seconds"),"seconds"===t&&(s.seconds=Math.floor(i/1e3),i-=1e3*s.seconds,t="milliseconds"),"milliseconds"===t&&(s.milliseconds=i),e&&l.each(s,function(e,t){s[e]=0===t?0:-t}),s},clone:function(){var e=new l.SaneDate(new Date(this.getVanillaDate().getTime()));return e.setUtc(this._utc),e},_setInvalid:function(){this._date=null,this._valid=!1},_padValueWithZero:function(e,t){t=l.orDefault(t,2,"int"),e=parseInt(e,10),l.assert(!l.isNaN(e),"SaneDate _padValueWithZero | value is not usable as int");var a=(e=""+e).length;if(a<t)for(var s=0;s<t-a;s++)e="0"+e;return e},_partsToDate:function(e,t){t=l.orDefault(t,!1,"bool");var e=l.extend({},e);if(e.year=this._padValueWithZero(e.year,4),e.month=this._padValueWithZero(e.month),e.date=this._padValueWithZero(e.date),"date"===e.type)return new Date(l.strFormat("{year}-{month}-{date}T00:00:00.0",e));if("datetime"===e.type)return e.hours=this._padValueWithZero(e.hours),e.minutes=this._padValueWithZero(e.minutes),e.seconds=this._padValueWithZero(e.seconds),l.isSet(e.milliseconds)&&(e.seconds+="."+e.milliseconds),e=new Date(l.strFormat("{year}-{month}-{date}T{hours}:{minutes}:{seconds}",e)),t?new Date(e.getTime()-6e4*e.getTimezoneOffset()):e;throw new Error("_partsToDate | unknown type")},_verifyDateParts:function(e){var t=this._partsToDate(e);if("date"===e.type)return parseInt(e.year,10)===(this._utc?t.getUTCFullYear():t.getFullYear())&&parseInt(e.month,10)===(this._utc?t.getUTCMonth()+1:t.getMonth()+1)&&parseInt(e.date,10)===(this._utc?t.getUTCDate():t.getDate());if("datetime"===e.type)return parseInt(e.year,10)===(this._utc?t.getUTCFullYear():t.getFullYear())&&parseInt(e.month,10)===(this._utc?t.getUTCMonth()+1:t.getMonth()+1)&&parseInt(e.date,10)===(this._utc?t.getUTCDate():t.getDate())&&parseInt(e.hours,10)===(this._utc?t.getUTCHours():t.getHours())&&parseInt(e.minutes,10)===(this._utc?t.getUTCMinutes():t.getMinutes())&&parseInt(e.seconds,10)===(this._utc?t.getUTCSeconds():t.getSeconds())&&(!l.isSet(e.milliseconds)||parseInt(e.milliseconds,10)===(this._utc?t.getUTCMilliseconds():t.getMilliseconds()));throw new Error("_verifyDateParts | unknown type")},_parseIsoString:function(e){var t={type:"date",year:null,month:null,date:null,hours:null,minutes:null,seconds:null,milliseconds:null},e=(e=""+e).split("T");if(2<=(e=1===e.length?e[0].split(" "):e).length){var a=e[1].split(":");if(!(3<=a.length))return null;var s=parseInt(a[0],10),s=(l.assert(!l.isNaN(s),"SaneDate _parseIsoString | hours not usable as int"),t.hours=this._padValueWithZero(s),parseInt(a[1],10)),s=(l.assert(!l.isNaN(s),"SaneDate _parseIsoString | minutes not usable as int"),t.minutes=this._padValueWithZero(s),a[2]),a=(2<=(s=(s=(s=(s=l.strReplace("Z","",s)).split("+")[0]).split("-")[0]).split(".")).length&&(a=parseInt(s[1],10),l.assert(!l.isNaN(a),"SaneDate _parseIsoString | milliseconds not usable as int"),t.milliseconds=""+a,3<t.milliseconds.length?t.milliseconds=t.milliseconds.substr(0,3):2===t.milliseconds.length?t.milliseconds=""+10*a:1===t.milliseconds.length&&(t.milliseconds=""+100*a)),parseInt(s[0],10));l.assert(!l.isNaN(a),"SaneDate _parseIsoString | seconds not usable as int"),t.seconds=this._padValueWithZero(a),t.type="datetime"}s=e[0].split("-");return 3<=s.length&&(a=parseInt(s[0],10),l.assert(!l.isNaN(a),"SaneDate _parseIsoString | year not usable as int"),l.assert(0<=a&&a<=9999,"SaneDate _parseIsoString | this implementation works with years between 0 and 9999"),t.year=this._padValueWithZero(a,4),e=parseInt(s[1],10),l.assert(!l.isNaN(e),"SaneDate _parseIsoString | month not usable as int"),t.month=this._padValueWithZero(e),a=parseInt(s[2],10),l.assert(!l.isNaN(a),"SaneDate _parseIsoString | date not usable as int"),t.date=this._padValueWithZero(a),this._verifyDateParts(t))?t:null},_tryDatePartChange:function(e,t,a,s){s=l.orDefault(s,!1,"bool");var n=this;if(!l.isSet(this._date)){if(s)throw new Error("SaneDate _tryDatePartChange | no date to change the part of");return!1}this._compareDate=new Date(this._date.getTime()),this._date[t](e);var i=!1;if(l.each(this._utc?["getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds"]:["getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds"],function(e,t){if(i=t!==a?i||n._date[t]()!==n._compareDate[t]():i)return!1}),i&&(this._date=this._compareDate),this._compareDate=null,!s)return i;if(i)throw new Error("SaneDate _tryDatePartChange | date part change is invalid or would change other parts")}}),l;throw"jQueryAnnex SaneDate Plugin | cannot extend jQuery Annex, since it does not seem to be available yet"});
//# sourceMappingURL=jquery.annex.sanedate-plugin.js.map
