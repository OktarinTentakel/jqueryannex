!function(e,t){var a=e.jQuery||e.$;if("function"==typeof define&&define.amd)define(["jqueryannex"],t);else if("object"==typeof module&&module.exports){if(!e.__AVA_ENV__)try{a||(a=require("jquery")),a.jqueryAnnexData||(a=require("jqueryannex"))}catch(e){}module.exports=a?t(a):function(e){return t(e)}}else t(a)}("undefined"!=typeof window?window:this,function(_){return function(){if(!_||!_.fn||!_().jquery)throw'jQueryAnnex SaneDate Plugin | cannot extend jQuery, since it does not seem to be available as "jQuery" or is missing basic functionality';if(!_.jqueryAnnexData)throw"jQueryAnnex SaneDate Plugin | cannot extend jQuery Annex, since it does not seem to be available yet"}(),_.extend({SaneDate:function(){}}),_.SaneDate=_.Class.extend({_date:null,_compareDate:null,_utc:!1,_ignoreInvalidPartChanged:!1,_valid:!0,init:function(e,t,a,s,n,i,r){_.isA(e,"date")||(e=_.orDefault(e,null,"string"));var o=!0,l={type:"date",year:null,month:_.orDefault(t,null,"int"),date:_.orDefault(a,null,"int"),hours:_.orDefault(s,null,"int"),minutes:_.orDefault(n,null,"int"),seconds:_.orDefault(i,null,"int"),milliseconds:_.orDefault(r,null,"int")};if(this._setupDatePartGettersAndSetters(),_.isSet(e))if(_.isA(e,"date"))_.isNaN(e.getDate())?this._setInvalid():this._date=e;else{if(!_.isA(e,"date"))if((""+e).indexOf("-")<0)l.year=parseInt(e,10),_.isSet(l.hours)&&(l.type="datetime");else try{l=this._parseIsoString(e)}catch(e){l=null}if(_.isSet(l))try{o=this._verifyDateParts(l)}catch(e){o=!1}_.isSet(l)&&o?this._date=this._partsToDate(l):this._setInvalid()}else this._date=new Date},_setupDatePartGettersAndSetters:function(){var t=this,e={enumerable:!0};Object.defineProperty(this,"valid",_.extend({},e,{set:function(){throw new Error("SaneDate set valid | valid is not settable")},get:function(){return this._valid}})),Object.defineProperty(this,"utc",_.extend({},e,{set:function(e){this.setUtc(e)},get:function(){return this._utc}})),Object.defineProperty(this,"year",_.extend({},e,{set:function(e){e=parseInt(e,10),_.assert(!_.isNaN(e),"SaneDate set year | value is not usable as int"),_.assert(0<=e&&e<=9999,"SaneDate set year | this implementation works with years between 0 and 9999"),t.utc?t._tryDatePartChange(e,"setUTCFullYear","getUTCFullYear",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e,"setFullYear","getFullYear",!t._ignoreInvalidPartChanged)},get:function(){if(_.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCFullYear():t._date.getFullYear()}})),Object.defineProperty(this,"month",_.extend({},e,{set:function(e){e=parseInt(e,10),_.assert(!_.isNaN(e),"SaneDate set month | value is not usable as int"),t.utc?t._tryDatePartChange(e-1,"setUTCMonth","getUTCMonth",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e-1,"setMonth","getMonth",!t._ignoreInvalidPartChanged)},get:function(){if(_.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCMonth()+1:t._date.getMonth()+1}})),Object.defineProperty(this,"date",_.extend({},e,{set:function(e){e=parseInt(e,10),_.assert(!_.isNaN(e),"SaneDate set date | value is not usable as int"),t.utc?t._tryDatePartChange(e,"setUTCDate","getUTCDate",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e,"setDate","getDate",!t._ignoreInvalidPartChanged)},get:function(){if(_.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCDate():t._date.getDate()}})),Object.defineProperty(this,"hours",_.extend({},e,{set:function(e){e=parseInt(e,10),_.assert(!_.isNaN(e),"SaneDate set hours | value is not usable as int"),t.utc?t._tryDatePartChange(e,"setUTCHours","getUTCHours",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e,"setHours","getHours",!t._ignoreInvalidPartChanged)},get:function(){if(_.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCHours():t._date.getHours()}})),Object.defineProperty(this,"minutes",_.extend({},e,{set:function(e){e=parseInt(e,10),_.assert(!_.isNaN(e),"SaneDate set minutes | value is not usable as int"),t.utc?t._tryDatePartChange(e,"setUTCMinutes","getUTCMinutes",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e,"setMinutes","getMinutes",!t._ignoreInvalidPartChanged)},get:function(){if(_.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCMinutes():t._date.getMinutes()}})),Object.defineProperty(this,"seconds",_.extend({},e,{set:function(e){e=parseInt(e,10),_.assert(!_.isNaN(e),"SaneDate set seconds | value is not usable as int"),t.utc?t._tryDatePartChange(e,"setUTCSeconds","getUTCSeconds",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e,"setSeconds","getSeconds",!t._ignoreInvalidPartChanged)},get:function(){if(_.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCSeconds():t._date.getSeconds()}})),Object.defineProperty(this,"milliseconds",_.extend({},e,{set:function(e){e=parseInt(e,10),_.assert(!_.isNaN(e),"SaneDate set milliseconds | value is not usable as int"),t.utc?t._tryDatePartChange(e,"setUTCMilliseconds","getUTCMilliseconds",!t._ignoreInvalidPartChanged):t._tryDatePartChange(e,"setMilliseconds","getMilliseconds",!t._ignoreInvalidPartChanged)},get:function(){if(_.isSet(t._date)&&t._valid)return t._utc?t._date.getUTCMilliseconds():t._date.getMilliseconds()}}))},setUtc:function(e){return this._utc=!!e,this},setIgnoreInvalidPartChanged:function(e){return this._ignoreInvalidPartChanged=!!e,this},getWeekDay:function(e){if(e=_.orDefault(e,!0,"bool"),_.isSet(this._date)&&this._valid){var t=this._utc?this._date.getUTCDay():this._date.getDay();return e&&0===t&&(t=7),e||(t+=1),t}},getIsoDateString:function(){if(_.isSet(this._date)&&this._valid){var e=this._utc?this._date.getUTCFullYear():this._date.getFullYear(),t=this._utc?this._date.getUTCMonth()+1:this._date.getMonth()+1,a=this._utc?this._date.getUTCDate():this._date.getDate();return t=t<10?"0"+t:""+t,a=a<10?"0"+a:""+a,(e=""+e)<1e3&&(e=this._padValueWithZero(e,4)),_.strFormat("{year}-{month}-{date}",{year:e,month:t,date:a})}return null},getIsoString:function(e){e=_.orDefault(e,!0,"bool");var t=this.getIsoDateString();if(_.isSet(t)){var a=this._utc?this._date.getUTCHours():this._date.getHours(),s=this._utc?this._date.getUTCMinutes():this._date.getMinutes(),n=this._utc?this._date.getUTCSeconds():this._date.getSeconds(),i=this._utc?this._date.getUTCMilliseconds():this._date.getMilliseconds();return a=a<10?"0"+a:""+a,s=s<10?"0"+s:""+s,n=n<10?"0"+n:""+n,i=""+i,t+(e?"T":" ")+_.strFormat("{hours}:{minutes}:{seconds}.{milliseconds}",{hours:a,minutes:s,seconds:n,milliseconds:i})}return null},getVanillaDate:function(){return this._valid?this._date:null},compareTo:function(e,t,a){t=_.orDefault(t,"datetime","string"),a=_.orDefault(a,!0,"bool");var s=this;if(_.isSet(this._date)&&this._valid){var n=null;if((n=_.isA(e,"object")&&_.hasMembers(e,["_date","_valid"])?e:new _.SaneDate(""+e))._valid){var i,r,o=0,l=[];return _.merge(l,["getFullYear","getMonth","getDate"]),"datetime"===t&&(_.merge(l,["getHours","getMinutes","getSeconds"]),a&&_.merge(l,["getMilliseconds"])),_.each(l,function(e,t){if(i=s._date[t](),r=n._date[t](),0!==(o=i<r?-1:r<i?1:0))return!1}),o}throw new Error("SaneDate compareTo | invalid compare date")}throw new Error("SaneDate compareTo | date currently not comparable")},move:function(e,t){t=_.orDefault(t,0,"int");var a=this,s=["years","months","days","hours","minutes","seconds","milliseconds"];if(_.isSet(this._date)&&this._valid){var n={};return _.isPlainObject(e)?n=e:n[""+e]=t,_.each(n,function(e,t){if(!(0<=_.inArray(""+e,s)))throw new Error("SaneDate _move | part must be one of years, months, days, hours, minutes, seconds, milliseconds");switch(""+e){case"years":a._date.setFullYear(a._date.getFullYear()+t);break;case"months":a._date.setMonth(a._date.getMonth()+t);break;case"days":a._date.setDate(a._date.getDate()+t);break;case"hours":a._date.setHours(a._date.getHours()+t);break;case"minutes":a._date.setMinutes(a._date.getMinutes()+t);break;case"seconds":a._date.setSeconds(a._date.getSeconds()+t);break;case"milliseconds":a._date.setMilliseconds(a._date.getMilliseconds()+t)}}),this}throw new Error("SaneDate _move | current date is not usable")},forward:function(e,t){t=_.orDefault(t,0,"int");var a={};return _.isPlainObject(e)?(a=e,_.each(a,function(e,t){a[e]=Math.abs(t)})):a[""+e]=Math.abs(t),this.move(a)},back:function(e,t){t=_.orDefault(t,0,"int");var a={};return _.isPlainObject(e)?(a=e,_.each(a,function(e,t){a[e]=0===t?0:-Math.abs(t)})):a[""+e]=0===t?0:-Math.abs(t),this.move(a)},delta:function(e,t,a){if(t=_.orDefault(t,"days","string"),_.inArray(t,["days","hours","minutes","seconds","milliseconds"])<0)throw new Error('SaneDate delta | largestUnit must be one of "days", "hours", "minutes", "seconds" or "milliseconds"');if(a=_.orDefault(a,!0,"bool"),_.isSet(this._date)&&this._valid){var s=null,n=null,i={};s=_.isA(e,"object")&&_.hasMembers(e,["_date","_valid"])?e:new _.SaneDate(""+e);var r=(n=a?Math.abs(this._date.getTime()-s._date.getTime()):this._date.getTime()-s._date.getTime())<0;return n=Math.abs(n),"days"===t&&(i.days=Math.floor(n/1e3/60/60/24),n-=1e3*i.days*60*60*24,t="hours"),"hours"===t&&(i.hours=Math.floor(n/1e3/60/60),n-=1e3*i.hours*60*60,t="minutes"),"minutes"===t&&(i.minutes=Math.floor(n/1e3/60),n-=1e3*i.minutes*60,t="seconds"),"seconds"===t&&(i.seconds=Math.floor(n/1e3),n-=1e3*i.seconds,t="milliseconds"),"milliseconds"===t&&(i.milliseconds=n),r&&_.each(i,function(e,t){i[e]=0===t?0:-t}),i}},clone:function(){var e=new _.SaneDate(new Date(this.getVanillaDate().getTime()));return e.setUtc(this._utc),e},_setInvalid:function(){this._date=null,this._valid=!1},_padValueWithZero:function(e,t){t=_.orDefault(t,2,"int"),e=parseInt(e,10),_.assert(!_.isNaN(e),"SaneDate _padValueWithZero | value is not usable as int");var a=(e=""+e).length;if(a<t)for(var s=0;s<t-a;s++)e="0"+e;return e},_partsToDate:function(e,t){t=_.orDefault(t,!1,"bool");var a=_.extend({},e);if(a.year=this._padValueWithZero(a.year,4),a.month=this._padValueWithZero(a.month),a.date=this._padValueWithZero(a.date),"date"===a.type)return new Date(_.strFormat("{year}-{month}-{date}T00:00:00.0",a));if("datetime"!==a.type)throw new Error("_partsToDate | unknown type");a.hours=this._padValueWithZero(a.hours),a.minutes=this._padValueWithZero(a.minutes),a.seconds=this._padValueWithZero(a.seconds),_.isSet(a.milliseconds)&&(a.seconds+="."+a.milliseconds);var s=new Date(_.strFormat("{year}-{month}-{date}T{hours}:{minutes}:{seconds}",a));return t?new Date(s.getTime()-6e4*s.getTimezoneOffset()):s},_verifyDateParts:function(e){var t=this._partsToDate(e);if("date"===e.type)return parseInt(e.year,10)===(this._utc?t.getUTCFullYear():t.getFullYear())&&parseInt(e.month,10)===(this._utc?t.getUTCMonth()+1:t.getMonth()+1)&&parseInt(e.date,10)===(this._utc?t.getUTCDate():t.getDate());if("datetime"===e.type)return parseInt(e.year,10)===(this._utc?t.getUTCFullYear():t.getFullYear())&&parseInt(e.month,10)===(this._utc?t.getUTCMonth()+1:t.getMonth()+1)&&parseInt(e.date,10)===(this._utc?t.getUTCDate():t.getDate())&&parseInt(e.hours,10)===(this._utc?t.getUTCHours():t.getHours())&&parseInt(e.minutes,10)===(this._utc?t.getUTCMinutes():t.getMinutes())&&parseInt(e.seconds,10)===(this._utc?t.getUTCSeconds():t.getSeconds())&&(!_.isSet(e.milliseconds)||parseInt(e.milliseconds,10)===(this._utc?t.getUTCMilliseconds():t.getMilliseconds()));throw new Error("_verifyDateParts | unknown type")},_parseIsoString:function(e){var t={type:"date",year:null,month:null,date:null,hours:null,minutes:null,seconds:null,milliseconds:null},a=(e=""+e).split("T");if(1===a.length&&(a=a[0].split(" ")),2<=a.length){var s=a[1].split(":");if(!(3<=s.length))return null;var n=parseInt(s[0],10);_.assert(!_.isNaN(n),"SaneDate _parseIsoString | hours not usable as int"),t.hours=this._padValueWithZero(n);var i=parseInt(s[1],10);_.assert(!_.isNaN(i),"SaneDate _parseIsoString | minutes not usable as int"),t.minutes=this._padValueWithZero(i);var r=s[2];if(2<=(r=(r=(r=(r=_.strReplace("Z","",r)).split("+")[0]).split("-")[0]).split(".")).length){var o=parseInt(r[1],10);_.assert(!_.isNaN(o),"SaneDate _parseIsoString | milliseconds not usable as int"),t.milliseconds=""+o,3<t.milliseconds.length?t.milliseconds=t.milliseconds.substr(0,3):2===t.milliseconds.length?t.milliseconds=""+10*o:1===t.milliseconds.length&&(t.milliseconds=""+100*o)}var l=parseInt(r[0],10);_.assert(!_.isNaN(l),"SaneDate _parseIsoString | seconds not usable as int"),t.seconds=this._padValueWithZero(l),t.type="datetime"}var u=a[0].split("-");if(!(3<=u.length))return null;var d=parseInt(u[0],10);_.assert(!_.isNaN(d),"SaneDate _parseIsoString | year not usable as int"),_.assert(0<=d&&d<=9999,"SaneDate _parseIsoString | this implementation works with years between 0 and 9999"),t.year=this._padValueWithZero(d,4);var h=parseInt(u[1],10);_.assert(!_.isNaN(h),"SaneDate _parseIsoString | month not usable as int"),t.month=this._padValueWithZero(h);var c=parseInt(u[2],10);return _.assert(!_.isNaN(c),"SaneDate _parseIsoString | date not usable as int"),t.date=this._padValueWithZero(c),this._verifyDateParts(t)?t:null},_tryDatePartChange:function(e,t,a,s){s=_.orDefault(s,!1,"bool");var n=this;if(!_.isSet(this._date)){if(s)throw new Error("SaneDate _tryDatePartChange | no date to change the part of");return!1}this._compareDate=new Date(this._date.getTime()),this._date[t](e);var i=!1;if(_.each(this._utc?["getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds"]:["getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds"],function(e,t){if(t!==a&&(i=i||n._date[t]()!==n._compareDate[t]()),i)return!1}),i&&(this._date=this._compareDate),this._compareDate=null,!s)return i;if(i)throw new Error("SaneDate _tryDatePartChange | date part change is invalid or would change other parts")}}),_});
//# sourceMappingURL=jquery.annex.sanedate-plugin.js.map
