<!DOCTYPE html>

<html>
	<head>
		<title>cssTransition Test</title>

		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

		<style type="text/css">
			#test {
				position: absolute;
				top: 30vh;
				left: 30vw;
				width: 150px;
				height: 150px;

				background: blue;

				transition: top 2s, left 1500ms, background-color 2.2s;
			}

			#test.test {
				top: 50vh;
				left: 50vw;

				background: red;
			}

			#test.test2 {
				top: 80vh;
				left: 80vw;

				background: green;

				transition: top 3100ms, left 1s, background-color 2.2s;
			}
		</style>

		<script src="lib/jquery-1.12.4.min.js"></script>
		<script src="lib/jquery.annex.js"></script>
		<script>$(function(){

			$('#test').on('click', function(){
				var $target = $(this);

				$.log().time();

				$target.cssTransition({addClass : 'test'}, function($element){
					$.log(1);
					$.log().timeEnd().time();
					$.log($element.attr('id'));

					$target.cssTransition({removeClass : 'test'}, function($element){
						$.log(2);
						$.log().timeEnd().time();
						$.log($element.attr('id'));
					});
				});

				$.schedule(3000, function(){
					$target.cssTransition({
						css : {
							top : 0,
							left : 0,
							background : 'pink',
							'-moz-transition' : 'all 1500ms'
						}
					}, function($element){
						$.log(3);
						$.log().timeEnd().time();
						$.log($element.attr('id'));

						$element
							.removeAttr('style')
							.cssTransition({
								css : {
									top : 'calc(100vh - 150px)',
									left : 'calc(100vw - 150px)',
									background : 'yellow'
								}
							}, function($element){
								$.log(4);
								$.log().timeEnd().time();
								$.log($element.attr('id'));

								$element.removeAttr('style');
							})
						;
					});
				});

				$.schedule(3000 + 3000, function(){
					$target.cssTransition({addClass : 'test2'}).done(function($element){
						$.log(5);
						$.log().timeEnd().time();
						$.log($element.attr('id'));
					}).fail(function($element){
						$.log('5 cancelled');
						$.log($element.attr('id'));
					});
				});

				$.schedule(3000 + 3000 + 1000, function(){
					$target.cssTransition({removeClass : 'test2'}, null, false).done(function($element){
						$.log(6);
						$.log().timeEnd();
						$.log($element.attr('id'));
					});
				});
			});

		});</script>
	</head>

	<body>
		<div id="test"></div>

		<p>click on the element to trigger transitions and keep an eye on the console for logging</p>
	</body>
</html>
